---
// Import the necessary dependencies
import FooterSocialLink from "@components/ui/links/FooterSocialLink.astro";
import EmailFooterInput from "@components/ui/forms/input/EmailFooterInput.astro";
import enStrings from "@utils/navigation.ts";
import frStrings from "@utils/fr/navigation.ts";
import esStrings from "@utils/es/navigation.ts";
import caStrings from "@utils/ca/navigation.ts";
import Icon from "@components/ui/icons/Icon.astro";
import TranscatLogo from "@components/TranscatLogo.astro";
import { SITE } from "@data/constants";
import TermsModal from "@components/ui/modals/TermsModal.astro";
import PrivacyModal from "@components/ui/modals/PrivacyModal.astro";
import DownloadModal from "@components/ui/modals/DownloadModal.astro";
import LogoModal from "@components/ui/modals/LogoModal.astro";
import diLogo from "@images/logos/di-logo.png";
import kitDigitalLogo from "@images/logos/KitDigital.png";

// Select the correct translation based on the page's lang prop:
let strings;
if (Astro.currentLocale === "fr") {
  strings = frStrings;
} else if (Astro.currentLocale === "es") {
  strings = esStrings;
} else if (Astro.currentLocale === "ca") {
  strings = caStrings;
} else {
  strings = enStrings;
}

// Define the variables that will be used in this component
let sectionThreeTitle: string;
let sectionThreeContent: string;
let crafted: string;

if (Astro.currentLocale === "fr") {
  sectionThreeTitle = "Rester à jour";
  sectionThreeContent = "Restez informé des derniers outils et des offres exclusives.";
  crafted = "Fabriqué par: ";
} else if (Astro.currentLocale === "es") {
  sectionThreeTitle = "Mantente informado";
  sectionThreeContent = "Recibe nuestras últimas novedades y ofertas exclusivas.";
  crafted = "Desarrollado por: ";
} else if (Astro.currentLocale === "ca") {
  sectionThreeTitle = "Mantén-te informat";
  sectionThreeContent = "Rep les nostres últimes novetats i ofertes exclusives.";
  crafted = "Desenvolupat per: ";
} else {
  sectionThreeTitle = "Stay up to date";
  sectionThreeContent = "Stay updated with the latest news and exclusive offers.";
  crafted = "Crafted by";
}
---

<footer class="w-full bg-neutral-300 dark:bg-neutral-900">
  <div
    class="mx-auto w-full max-w-[85rem] px-2 py-10 sm:px-4 lg:px-8 lg:pt-20 2xl:max-w-(--breakpoint-2xl)"
  >
    <div class="mt-8 flex flex-wrap">
      <div class="w-full lg:w-1/5 mb-8 lg:mb-0">
        <!-- Brand Logo and Quote -->
        <div class="flex flex-col items-start">
          <div class="w-56">
            <TranscatLogo class="h-auto w-full" />
          </div>
        </div>
      </div>
      
      <div class="flex flex-wrap w-4/5">
        <!-- Primera columna de enlaces dinámicos -->
        <div class="w-1/5 pr-0 mr-0">
          <h3 class="font-bold text-neutral-800 dark:text-neutral-200">
            {strings.footerLinks[0].section}
          </h3>
          <ul class="mt-3 grid space-y-3">
            {strings.footerLinks[0].links.map((link, index) => (
              <li>
                <a
                  href={link.url}
                  class="inline-flex gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden"
                >
                  {link.name}
                </a>
                {strings.footerLinks[0].section === "Company" && index === 2 ? (
                  <span class="ms-1 inline rounded-lg bg-orange-500 px-2 py-1 text-xs font-bold text-neutral-50">
                    We're hiring!
                  </span>
                ) : null}
              </li>
            ))}
          </ul>
        </div>

        <!-- Columna de información de contacto -->
        <div class="w-[22%] pl-0">
          <h3 class="font-bold text-left text-neutral-800 dark:text-neutral-200">
            Info de Contacto
          </h3>
          <ul class="mt-3 grid space-y-3 text-left">
          <li>
            <a href="tel:+34600123456" class="inline-flex items-center gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden">
              <Icon name="phone" class="h-5 w-5 shrink-0 fill-white text-white dark:fill-white dark:text-white" />
              <span>+34 93 123 45 67<br/>+34 612 345 678</span>
            </a>
          </li>
          <li>
            <a href="mailto:info@transcat.com" class="inline-flex items-center gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden">
              <Icon name="envelopeOpen" class="h-5 w-5 shrink-0 fill-white text-white dark:fill-white dark:text-white" />
              <span>info@transcat.com</span>
            </a>
          </li>
          <li>
            <div class="inline-flex items-center gap-x-2 rounded-lg text-neutral-600 dark:text-neutral-400">
              <Icon name="map" class="h-5 w-5 shrink-0 fill-white text-white dark:fill-white dark:text-white" />
              <span>Carrer de la Indústria 140,<br/>08025 Barcelona, España</span>
            </div>
          </li>
          <li>
            <div class="inline-flex items-center gap-x-2 rounded-lg text-neutral-600 dark:text-neutral-400">
              <Icon name="clock" class="h-5 w-5 shrink-0 fill-white text-white dark:fill-white dark:text-white" />
              <span>Lun-Sáb: 9:00-19:00</span>
            </div>
          </li>
          </ul>
        </div>

        <!-- Cuarta columna -->
        <div class="w-[18%] pl-0">
          <h3 class="font-bold text-neutral-800 dark:text-neutral-200">
            {strings.footerLinks[1].section}
          </h3>
          <ul class="mt-3 grid space-y-3">
            {strings.footerLinks[1].links.map((link, index) => (
              <li>
                {index === 0 ? (
                  <a
                    href={link.url}
                    class="inline-flex gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden"
                  >
                    {link.name}
                  </a>
                ) : index === 1 ? (
                  <a
                    href="#"
                    class="terms-link inline-flex gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden"
                  >
                    {link.name}
                  </a>
                ) : index === 2 ? (
                  <a
                    href="#"
                    class="privacy-link inline-flex gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden"
                  >
                    {link.name}
                  </a>
                ) : index === 3 ? (
                  <a
                    href="#"
                    class="download-link inline-flex gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden"
                  >
                    {link.name}
                  </a>
                ) : (
                  <a
                    href={link.url}
                    class="inline-flex gap-x-2 rounded-lg text-neutral-600 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-500 focus-visible:ring-3 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:text-neutral-300 dark:focus:outline-hidden"
                  >
                    {link.name}
                  </a>
                )}
              </li>
            ))}
          </ul>
        </div>
        
        <!-- Componente de suscripción y redes sociales -->
        <div class="w-[35%] pl-4">
          <h3 class="font-bold text-neutral-800 dark:text-neutral-200">
            {sectionThreeTitle}
          </h3>

          <form>
            <EmailFooterInput />
            <p class="mt-3 text-sm text-neutral-600 dark:text-neutral-400">
              {sectionThreeContent}
            </p>
          </form>
          
          <h3 class="mt-6 font-bold text-neutral-800 dark:text-neutral-200">
            Redes Sociales
          </h3>
          
          <!-- Social Media Icons -->
          <div class="mt-3 flex flex-wrap gap-3">
            {/* Verificar si la propiedad existe antes de usarla */}
            {strings.socialLinks && strings.socialLinks.facebook && (
              <FooterSocialLink url={strings.socialLinks.facebook}>
                <Icon name="facebook" class="h-5 w-5 fill-white text-white dark:fill-white dark:text-white" />
              </FooterSocialLink>
            )}

            {strings.socialLinks && strings.socialLinks.x && (
              <FooterSocialLink url={strings.socialLinks.x}>
                <Icon name="x" class="h-5 w-5 fill-white text-white dark:fill-white dark:text-white" />
              </FooterSocialLink>
            )}
            
            {strings.socialLinks && strings.socialLinks.instagram && (
              <FooterSocialLink url={strings.socialLinks.instagram}>
                <Icon name="instagram" class="h-5 w-5 fill-white text-white dark:fill-white dark:text-white" />
              </FooterSocialLink>
            )}
            
            {strings.socialLinks && strings.socialLinks.linkedin && (
              <FooterSocialLink url={strings.socialLinks.linkedin}>
                <Icon name="linkedin" class="h-5 w-5 fill-white text-white dark:fill-white dark:text-white" />
              </FooterSocialLink>
            )}
            
            {strings.socialLinks && strings.socialLinks.whatsapp && (
              <FooterSocialLink url={strings.socialLinks.whatsapp}>
                <Icon name="whatsapp" class="h-5 w-5 fill-white text-white dark:fill-white dark:text-white" />
              </FooterSocialLink>
            )}
          </div>
        </div>
      </div>
    </div>

    <div
      class="mt-9 flex flex-col items-center justify-center gap-y-4"
    >
      <!-- Frase de TransCat -->
      <div class="text-center mb-2">
        <p class="text-sm text-neutral-600 dark:text-neutral-400 italic">
          "Gracias por confiar en TransCat. Nos vemos en la Ruta!."
        </p>
        <p class="mt-1 text-sm text-neutral-600 dark:text-neutral-400">
          — Jordi, tu transportista de confianza.
        </p>
      </div>
      
      <!-- Línea de separación -->
      <div class="w-24 h-px bg-neutral-400 dark:bg-neutral-700 my-2"></div>
      
      <!-- Copyright -->
      <div class="text-center">
        <p class="text-sm text-neutral-600 dark:text-neutral-400">
          © <span id="current-year"></span> TransCat. Todos los derechos reservados. {crafted}
          <a
            class="rounded-lg font-medium underline underline-offset-2 outline-hidden ring-zinc-500 transition duration-300 hover:text-neutral-700 hover:decoration-dashed focus:outline-hidden focus-visible:ring-3 dark:ring-zinc-200 dark:hover:text-neutral-300"
            href="#"
            target="_blank"
            rel="noopener noreferrer">Digitalización Integral</a
          >.
        </p>
      </div>
      
      <!-- Logo DI -->
      <div class="mt-4 mb-8">
        <a href="#" class="logo-link inline-block">
          <img 
            src={diLogo.src} 
            alt="Digitalización Integral" 
            class="h-14 w-auto rounded-lg shadow-sm border border-neutral-200 dark:border-neutral-700 dark:brightness-90 hover:opacity-90 transition-all hover:shadow-md" 
          />
        </a>
      </div>

      <!-- Línea separadora para KitDigital -->
      <!-- <div class="w-1/3 mx-auto h-0.5 bg-neutral-400 dark:bg-neutral-700 my-8"></div> -->
      
      <!-- Logo KitDigital -->
      <div class="w-full bg-white dark:bg-neutral-800 py-12 px-8 flex justify-center">
        <img 
          src={kitDigitalLogo.src} 
          alt="Kit Digital" 
          class="w-full max-w-3xl h-auto dark:brightness-90" 
        />
      </div>
      
      <!-- Espacio adicional al final -->
      <!-- <div class="py-8"></div>  -->
    </div>

    <script is:inline>
      // @ts-nocheck
      const year = new Date().getFullYear();
      const element = document.getElementById("current-year");
      if (element) {
        element.innerText = year.toString();
      }
      
      // Script para scroll suave en enlaces con hash (#)
      document.addEventListener('DOMContentLoaded', () => {
        const footerLinks = document.querySelectorAll('footer a[href*="#"]');
        
        footerLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            // Solo aplicar a enlaces internos (mismo dominio)
            const href = this.getAttribute('href');
            if (!href) return;
            
            // Verificar si el enlace contiene un hash y está en la misma página o en la página de inicio
            if (href.includes('#')) {
              const targetPage = href.split('#')[0];
              const currentPath = window.location.pathname;
              
              // Si estamos en la misma página o el enlace es a la página principal
              if (currentPath === targetPage || targetPage === '/es' || targetPage === '') {
                e.preventDefault();
                
                const targetId = href.split('#')[1];
                const targetElement = document.getElementById(targetId);
                
                if (targetElement) {
                  // Usar setTimeout para asegurar que el scroll ocurra después de cualquier otro evento
                  setTimeout(() => {
                    window.scrollTo({
                      top: targetElement.offsetTop - 100, // Offset para evitar que el header cubra el contenido
                      behavior: 'smooth'
                    });
                  }, 10);
                }
              }
            }
          });
        });
      });
    </script>
  </div>
</footer>

<!-- Modales -->
<TermsModal />
<PrivacyModal />
<DownloadModal />
<LogoModal />
